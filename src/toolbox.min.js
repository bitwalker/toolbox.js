(function(p,b,d){"object"===typeof exports&&(exports=b(p,exports,!1,b));"function"===typeof define?define("toolbox",null,function(){return b(p,null,!1,b)}):p.toolbox=b(p,null,!1,b)})(this,function(p,b,d,W,D){function E(a){var c=/[\S]+/g;return!k(a)||!c.test(a)}function X(a,c){c=c||1;if(!h(a,"string"))throw new Exception("repeat: str must be a string.");if(!h(c,"number"))throw new Exception("repeat: n must be a number.");for(var f=a,e=1;e<c;e++)f+=a;return f}function Y(a){var c=g(arguments);h(a,"string")?
c=g(c,1):a="";return c.length?q(c,function(c,e){var b="",b=h(e,"array")?q(e,function(c,f){return E(c)?f.toString():c+a+f.toString()},""):k(e.toString)?e.toString():Object.prototype.toString.call(e);return E(c)?b:k(a)?c+a+b:c+b},""):""}function t(a){function c(a,c){var b=a;l(c,function(a,c){if(h(a,"object"))for(var f in a){var e=RegExp("#\\{"+f+"\\}","g");b=b.replace(e,a[f])}else e=RegExp("#\\{"+c+"\\}","g"),b=b.replace(e,a.toString())});return b}return function(a,e){if(h(a,"regexp")||h(a,"string")){var b,
d=/#\{[\d]+\}|#\{[\w-_]+\}/g,g=[];h(a,"regexp")?(b=/.+\/([gim]+)?$/.exec(a.toString()),b.shift(),b=/^\/(.+)\/[gim]+?$/.exec(a.toString()),b.shift(),b=b[0]):b=a;e.length&&(g=d.test(b)?b.match(d).length:0,g===e.length?b=c(b,e):g<e.length?b=c(b,e):g>e.length&&(d=e[e.length-1],b=c(b,e),b=b.replace(interpolationPattern,d.toString())));return b}throw Error("Invalid type passed as interpolation target. Must be string or RegExp.");}(a,g(arguments,1))}function v(a){return"undefined"===typeof a?"undefined":
null===a?"null":a.constructor&&a.constructor.name?a.constructor.name.toLowerCase():Object.prototype.toString.call(a).toLowerCase()}function h(a){var c=g(arguments,1);if(!c.length)throw new Exception("isType requires at least two arguments.");for(var f=0;f<c.length;f++){var b="string"===typeof c[f]?c[f]:v(c[f]);if(a===D&&("undefined"===b||b===D)||null===a&&("null"===b||null===b)||v(a)===b)return!0}return!1}function k(a){return!h(a,"null","undefined")}function s(a,c){if(!k(a))throw new Exception("has: Object does not exist.",
arguments);return k(c)?Object.prototype.hasOwnProperty.call(a,c)?!0:!1:q(Object.keys(a),function(c,b){Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c},[])}function Z(a,c,f){this===a&&(f=J(["configure","config"],f));f=$(F,f||[]);var b=u(K(c),"name"),n=u(L(c),"name");f=M(m(b,n),f);l(f,function(f){a[f]=c[f]});return a}function aa(a){if(this===a)throw new Exception("extend: Cannot extend toolbox. Use mixin instead.",this);var c=g(arguments,1);c.length&&l(c,function(c){var b=u(b(c),"name"),
n=u(n(c),"name");l(m(b,n),function(b){a[b]=c[b]})});return a}function w(a){return h(a,"function")}function K(a){var c=[],f;for(f in a)if(s(a,f)&&w(a[f])){var b={name:f,fn:B(a[f],a),arguments:a[f].length};c.push(b)}return c}function L(a){var c=[],f;for(f in a)if(s(a,f)&&!w(a[f])){var b={name:f,get:function(c){return B(function(){return this[c]},a)}(f),set:function(c){return B(function(a){this[c]=a},a)}(f)};c.push(b)}return c}function u(a,c){return q(a,function(a,b){b[c]&&a.push(b[c]);return a},[])}
function N(a,c){return O(a,c,[],[])}function O(a,c,b,e){if(a===c)return 0!==a||1/a==1/c;if(null===a||null===c)return a===c;if(!h(a,c))return!1;switch(v(a)){case "string":return a==String(c);case "number":return a!==+a?c!==+c:0===a?1/a===1/c:a===+c;case "date":case "boolean":return+a==+c;case "regexp":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;for(var n=b.length;n--;)if(b[n]==a)return e[n]==
c;b.push(a);e.push(c);var n=0,d=!0;if(h(a,"array")){if(n=a.length,d=n==c.length)for(;n--&&(d=O(a[n],c[n],b,e)););}else{var g=a.constructor,k=c.constructor;if(g!==k&&(!w(g)||!(g instanceof g&&w(k)&&k instanceof k)))return!1;for(var l in a)if(s(a,l)&&(n++,!(d=s(c,l)&&O(a[l],c[l],b,e))))break;if(d){for(l in c)if(s(c,l)&&!n--)break;d=!n}}b.pop();e.pop();return d}function l(a,c,b){if(!a)throw new Exception("forEach: Array is null or undefined.",arguments);if(!h(c,"function"))throw new Exception("forEach: Iterator is not callable.",
arguments);var e=a.length>>>0,d=0;for(b=b||null;d<e;)s(a,d)&&c.call(b,a[d],d,a),d++}function ba(a,c){var b=[];l(a,function(a,d,g){b.push(c.call(null,a,d,g))});return b}function q(a,c,b){if(!k(b))throw new Exception("No initial value was provided.",arguments);var e=b;l(a,function(a,b,f){e=c.call(null,e,a,b,f)});return e}function P(a,c,b){if("function"!==typeof c)throw new Exception("Predicate is not callable.",arguments);var e=[];l(a,function(a,d,g){c.call(b,a,d,g)&&e.push(a)});return e}function g(a,
c,b){return Array.prototype.slice.call(a,c,b)}function m(){return Array.prototype.concat.apply([],g(arguments))}function G(a){return a[0]}function ca(a){return 0<a.length?a[a.length-1]:null}function x(a){return g(a,1)}function F(a,c){return Q(a,function(a){return N(c,a)})}function R(a){var c=[];l(a,function(a){F(c,a)||c.push(a)});return c}function J(){return q(g(arguments),function(a,c){var b=m(a,c);return R(b)},[])}function M(a,c){return q(a,function(a,b){c(b)||a.push(b);return a},[])}function Q(a,
c){if(!h(c,"function"))throw new Exception("any: predicate is not callable.");if(!h(a,"array","object"))throw new Exception("any: collection provided is not an enumerable object.");return q(a,function(a,b){return a?!0:c(b)},!1)}function da(a,c){if(!h(c,"function"))throw new Exception("all: predicate is not callable.");if(!h(a,"array","object"))throw new Exception("all: collection provided is not an enumerable object.");return q(a,function(a,b){return a?c(b):!1},!0)}function S(a,c,b){if(0===a.length)return c;
if(0===c.length)return a;k(b)||(b=function(a,c){return m(a,c)});var e=b(head(a),head(c));a=S(x(a),x(c),b);return m(e,a)}function ea(a){return q(a,function(a,b){return a+b},0)}function fa(a,c){if(c>a.length)return a;for(var b=[],e=0;e<c;e++)b.push(a[e]);return b}function ga(a,c){if(c>a.length)return[];for(var b=0;b<c;b++)a.shift();return a}function ha(){}function ia(a){return a}function B(a,c){return function(){return a.apply(c,g(arguments))}}function $(a){var c=g(arguments,1);return function(){var b=
g(arguments);return a.apply(null,m(c,b))}}function C(){function a(a){p.console&&p.console.log&&p.console.log(a)}this.level=y.all;this.log=function(c){var b=g(arguments,1);c.gte(this.level)&&l(b,function(b){if("string"===typeof b)a(t("#{0}: #{1} - #{2}",new Date,c.name,b));else if(b instanceof Exception)a(b);else if(b instanceof Error){var f=t,d=new Date,g=c.name;var h=b.message||b.description||String(b);b?(h=t("Exception: #{0}",h),b.lineNumber&&(h=t("#{0} on line: #{1}",h,b.lineNumber)),b.fileName&&
(h=t("#{0} in file: #{1}",h,b.fileName)),b.stack&&(h=t("#{e}#{newline}Stack Trace:#{newline}#{stack}",{e:h,newline:newline,stack:b.stack})),b=h):b="N/A";a(f("#{0}: #{1} - #{2}",d,g,b))}else p.console&&p.console.dir?p.console.dir(b):null!==JSON&&JSON!==D&&a(JSON.stringify(b))})}}function r(a,c){this.level=a;this.name=c}function T(a,c){this.context=c;this.message=a;return this}function U(){this.message="Iteration of the underlying collection has been completed.";return this}function z(a){var c=[],b=
this;l(a,function(a,d){var g=String(a),h=new V(g,d);b[g]=h;c.push(h)});this.values=function(){return c}}function V(a,c){this.name=a;this.value=c}b=b||{};b.version="2.1.4";var H={extendPrototypes:!1,createGlobalAliases:!1},I={extendPrototypes:!0,createGlobalAliases:!0};switch(v(d)){case "null":case "undefined":case "boolean":d=d?I:H;break;case "object":var I={},A;for(A in H)I[A]=null!==d[A]&&d[A]!==D?d[A]:H[A];d=I;break;default:d=H}b.configure=function(a){return W.call(null,p,b,a,W)};b.config=function(){return d};
b.string={};b.string.empty="";b.string.newline="\r\n";b.string.trim=function(a){return String.prototype.trim.call(a)};b.string.isEmpty=E;d.extendPrototypes&&(String.prototype.isEmpty=function(){return E.call(null,this)});b.string.repeat=X;d.extendPrototypes&&(String.prototype.repeat=function(a){return X.call(null,this,a)});b.string.str=Y;b.string.format=t;b.object={};d.extendPrototypes&&(Object.prototype.getType=function(){return v.call(null,this)});b.object.getType=v;b.object.isType=h;d.extendPrototypes&&
(Object.prototype.isType=function(){var a=m(this,g(arguments));return h.apply(null,a)});b.object.exists=k;b.object.has=s;d.extendPrototypes&&(Object.prototype.has=Object.prototype.hasOwnProperty||function(a){return s.call(null,this,a)});b.object.mixin=Z;d.extendPrototypes&&(Object.prototype.mixin=function(a,c){return Z.call(null,this,a,c)});b.object.extend=aa;d.extendPrototypes&&(Object.prototype.extend=function(){var a=m(this,g(arguments));return aa.apply(null,a)});b.object.isFunction=w;b.object.functions=
K;d.extendPrototypes&&(Object.prototype.functions=function(){return K.call(null,this)});b.object.properties=L;d.extendPrototypes&&(Object.prototype.properties=function(){return L.call(null,this)});b.object.pick=u;d.extendPrototypes&&(Object.prototype.pick=function(a){return u.call(null,this,a)});b.object.areEqual=N;d.extendPrototypes&&(Object.prototype.areEqual=function(a){return N.call(null,this,a)});b.array={};b.array.forEach=l;d.extendPrototypes&&(Array.prototype.forEach=Array.prototype.forEach||
function(a,c){return l.call(null,this,a,c)});b.array.map=ba;d.extendPrototypes&&(Array.prototype.map=Array.prototype.map||function(a){return ba.call(null,this,a)});b.array.reduce=q;d.extendPrototypes&&(Array.prototype.reduce=Array.prototype.reduce||function(a,c){return q.call(null,this,a,c)});b.array.filter=P;d.extendPrototypes&&(Array.prototype.filter=Array.prototype.filter||function(a,c){return P.call(null,this,a,c)});b.array.slice=g;b.array.concat=m;b.array.append=function(a){return m(a,g(arguments,
1))};b.array.cons=function(a,c){return m(a,c)};b.array.first=G;b.array.head=G;d.extendPrototypes&&(Array.prototype.first=function(){return G.call(null,this)},Array.prototype.head=function(){return G.call(null,this)});b.array.last=ca;d.extendPrototypes&&(Array.prototype.last=function(){return ca.call(null,this)});b.array.tail=x;b.array.rest=x;d.extendPrototypes&&(Array.prototype.tail=function(){return x.call(null,this)},Array.prototype.rest=function(){return x.call(null,this)});b.array.contains=F;
d.extendPrototypes&&(Array.prototype.contains=function(a){return F.call(null,this,a)});b.array.find=function(a,c){for(var b=0;b<a.length;b++)if(c(a[b]))return a[b];return null};b.array.unique=R;d.extendPrototypes&&(Array.prototype.unique=function(){return R.call(null,this)});b.array.union=J;d.extendPrototypes&&(Array.prototype.union=function(){return J.call(null,this)});b.array.reject=M;d.extendPrototypes&&(Array.prototype.reject=function(a){return M.call(null,this,a)});b.array.any=Q;d.extendPrototypes&&
(Array.prototype.any=function(a){return Q.call(null,this,a)});b.array.all=da;d.extendPrototypes&&(Array.prototype.all=function(a){return da.call(null,this,a)});b.array.zip=S;d.extendPrototypes&&(Array.prototype.zip=function(a,b){return S.call(null,this,a,b)});b.array.sum=ea;d.extendPrototypes&&(Array.prototype.sum=function(){return ea.call(null,this)});b.array.take=fa;d.extendPrototypes&&(Array.prototype.take=function(a){return fa.call(null,this,a)});b.array.drop=ga;d.extendPrototypes&&(Array.prototype.drop=
function(a){return ga.call(null,this,a)});b.array.range=function(a,b){if(!k(a)&&!k(b))return[];k(b)||(b=a,a=0);for(var f=[],d=a;d<=b;d++)f.push(d);return f};b.Generator=function(a,b){if(!k(a)||!h(a,"function"))throw new Exception("Generator: generator function must be a function.");k(b)||(b=null);var f=b;this.next=function(){return f=a.call(null,f)};this.take=function(a){for(var b=[];b.length<a;)b.push(this.next());return b};this.drop=function(a){for(;0<a;)this.next()}};b.Enumerator=function(a){if(!k(a)||
!h(a,"array","object"))a=[];var b=Object.keys(a);this.next=function(){if(0!==b.length)return a[b.shift()];throw new U;};this.reset=function(){b=Object.keys(a)};this.count=function(){return Object.keys(a).length}};b.random={};b.random.chars=function(a){a=a||32;for(var b=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",1,2,3,4,5,6,7,8,9],f=[],
d=0;d<a;d++)f.push(b[Math.floor(61*Math.random())]);return f.toString().replace(/[,]/g,"")};b.random.digits=function(a){a=a||32;for(var b="";b.length<a;)b+=Math.random().toString(10).slice(2);return b.slice(0,a)};b.random.hex=function(a){a=a||32;for(var b="";b.length<a;)b+=Math.random().toString(16).slice(2);return b.slice(0,a)};b.random.uuid=function(){return randomHex(8)+"-"+randomHex(4)+"-4"+randomHex(3)+"-"+randomHex(8)+randomHex(4)};b.func={};b.func.noop=ha;d.extendPrototypes&&(Function.prototype.noop=
ha);b.func.identity=ia;d.extendPrototypes&&(Function.prototype.identity=ia);b.func.bind=B;d.extendPrototypes&&(Function.prototype.bind=Function.prototype.bind||function(a){return B.call(null,this,a)});b.func.partial=$;b.func.juxt=function(){var a=g(arguments);if(!a.length)throw Error("juxt requires at least one argument.");return function(){var b=g(arguments);return q(a,function(a,d){a.push(d.apply(null,b));return a},[])}};b.func.complement=function(a){return function(){return!a.apply(null,g(arguments))}};
b.func.thread=function(a){var b=g(arguments,1);return b.length?q(b,function(a,b){return b.apply(null,[a])},a):a};b.func.curry=function(a,b){if(a&&b)return function(){var d=g(arguments),d=b.apply(null,d);return a.apply(null,[d])};throw Error("Curry only accepts two functions.");};b.func.defmulti=function(a,b){if(!h(a,"function"))throw new Exception("defmulti: dispatcher must be a function");if(!h(b,"function"))throw new Exception("defmulti: $default must be a function");var d=[],e=g(arguments,2);l(e,
function(a){if(!h(a,"object")||!h(a.name,"string")||!h(a.fn,"function"))throw new Exception("defmulti: Function definition is not valid.",fn);d.push(a)});return function(){var e=g(arguments),k=a.apply(null,e);if(!h(k,"object")||!h(k.dispatch,"string"))throw new Exception("defmulti: expected a dispatch configuration object, but was invalid.",k);var m=P(d,function(a){return a.name===k.dispatch});0<m.length?l(m,function(a){a.fn.apply(null,e)}):b.apply(null,e)}};b.func.memoize=function(a){return function(){var b=
g(arguments),d="",e=b.length;for(currentArg=null;e--;)currentArg=b[e],d+=currentArg===Object(currentArg)?JSON.stringify(currentArg):currentArg,a.memoize=a.memoize||{};d in a.memoize||(a.memoize[d]=a.apply(this,b));return a.memoize[d]}};b.func.once=function(a){var b;return function(){k(b)||(b=a.apply(null,arguments));return b}};b.func.delay=function(a,b){b=k(b)?b:100;var d=function(e){var g=null,g=setTimeout(function(){e();clearTimeout(g);g=null;h(a,"array")&&0<a.length&&d(a.shift())},k(b)?b:100)};
d(w(a)?a:a.shift())};b.func.repeat=function(a,b){for(var d=b;0<d;)a(),d--};b.logging={};var y={all:new r(0,"all"),debug:new r(1,"debug"),info:new r(2,"info"),warn:new r(3,"warn"),error:new r(4,"error"),none:new r(5,"none")};b.logging.Levels=y;C.prototype.debug=function(){var a=m(y.debug,g(arguments));this.log.apply(this,a)};C.prototype.info=function(){var a=m(y.info,g(arguments));this.log.apply(this,a)};C.prototype.warn=function(){var a=m(y.warn,g(arguments));this.log.apply(this,a)};C.prototype.error=
function(){var a=m(y.error,g(arguments));this.log.apply(this,a)};r.prototype.toString=function(){return this.name};r.prototype.eq=function(a){return this.level===a.level};r.prototype.gte=function(a){return this.level>=a.level};b.logging.Level=r;b.log=new C;T.prototype.toString=function(){return"ApplicationException: "+this.message};b.ApplicationException=T;U.prototype.toString=function(){return"StopIterationException: "+this.message};b.StopIterationException=U;z.prototype.toString=function(){return Y(", ",
u(this.values(),"name"))};z.prototype.next=function(a){return this.values().length<a.value+1?this.values()[0]:this.values()[a.value+1]};z.prototype.previous=function(a){return 0===a.value?this.values()[this.values.length-1]:this.values()[a.value-1]};z.prototype.fromValue=function(a){if(this.values().length<a)throw new T("Enumeration.fromValue: Invalid value.",a);return this.values()[a]};z.prototype.fromName=function(a){if("undefined"===typeof this[a]){for(var b=this.values(),d=0;d<b.length;d++)if(b[d].name.toLowerCase()===
a.toLowerCase())return b[d];return null}return this[a]};b.Enumeration=z;V.prototype.toString=function(){return this.name};V.prototype.eq=function(a){return k(a)&&this.value===a.value&&this.name===a.name};d.createGlobalAliases&&l("string object array func random log ApplicationException StopIterationException Generator Enumerator Enumeration".split(" "),function(a){k(p[a])?b.log.warn("Unable to add toolbox."+a+" to global namespace. Name already exists."):p[a]=b[a]});return b});
